Attribute VB_Name = "modMatrices"

'           SSSSS AAAAA DDDD  AAAAA M   M H   H U   U
'           S   S A   A D   D A   A MM MM H   H U   U
'           S     A   A D   D A   A M M M H   H U   U
'           SSSSS AAAAA D   D AAAAA M   M HHHHH U   U
'               S A   A D   D A   A M   M H   H U   U
'           S   S A   A D   D A   A M   M H   H U   U
'           SSSSS A   A DDDD  A   A M   M H   H  UUU

'              !!THANK YOU FOR DOWNLOADING THIS!!

'      Please learn from this code, everyone else tought me it.

'                Some of it is M$, dont tell Bill!!

'         Print out the skinmesh classes and read them on the floor
'       (thats what I did(after making it more simple from the SDK))



'        ..jj
'        iiWW..            iiLL
'        tt##;;            ttDD
'        ffWWtt            ttEE
'        LLDDLL            iiKK
'        GGffEE            iiKK                          iiKKGG..
'        DD;;KK;;          ;;WW                  ..;;tt..EEttLLGG
'        EE,,LLLLDDtt      ,,WW        LLKKii    iiWWKKKKKK    DDii
'        KK..ff##tt      ..ttWW..    ttDDiiWW..  ..##ttGGKK    ttLL
'        KKiiKKKK..    ;;KKEE##..    LLtt  KKii    ##ii;;ii    ;;ii
'      ..KKKKttGGii    GGtt..##ii    ffff  DDDD....KK..
'      tt##tt  ffLL  ..KK....WWLL    ;;KKiiKKGGKKKK;;
'    ttKKKK    iiDD  ..KK..iiEEEEffjj..ttEELL  ..,,                                      iiGGffLLtt
'  ttEE;;KK..    KK..  GGffLLff;;LLff                ..;;  tt;;                      LL;;KKjjfftt..
'  LL;;  KK..    LLii  ..EEKK,,                      iiDD  ttGG    ..      ..fftt    EEDDff
'      ..KK      iiGG      ..                        ..KK  ;;EE  ;;KK    ;;KKffKK..  LL##ii
'      ;;EE        ..                                  KK..  KK::  ;;    KKttLLGG  iijj##tt
'      ;;DD                      ..                    DD;;  LLtt  ;;  ;;WWDDLL..;;KK;;KKff
'      ..tt                  ,,GGKK;;        ..jjDDii  LLtt  jjLL..KK  ..WWjj  iiEEtt  LLGG
'                          ..EEff..          ff##jjKK..jjLL  iiGG  DD..  jjKKEEEEtt    ;;ff
'                          ffLL              GGff  LLtt;;DD  ;;EE  LLtt    ..;;
'                          DDii        ::;;  GGtt  GGtt  KK;;  KK;;tttt
'                        ..KK..        iiGG  iiKKKKGG..  LLLL  GGtt
'                          KK::        GGff      ..      iitt  ;;::
'                          ffKKttiiiiGGDD..
'                            iiGGDDGGtt
'                                                                               Adam Collier
Option Explicit

Public Sub SetWorld(Position As D3DVECTOR, Angle As D3DVECTOR, Scaling As D3DVECTOR)
Dim matworld As D3DMATRIX
Dim matTemp As D3DMATRIX

D3DXMatrixIdentity matworld

With Scaling
D3DXMatrixIdentity matTemp
D3DXMatrixScaling matTemp, .X, .Y, .Z
D3DXMatrixMultiply matworld, matworld, matTemp
End With

With Angle
D3DXMatrixIdentity matTemp
D3DXMatrixRotationY matTemp, .X * sngRad
D3DXMatrixMultiply matworld, matworld, matTemp

D3DXMatrixIdentity matTemp
D3DXMatrixRotationX matTemp, .Y * sngRad
D3DXMatrixMultiply matworld, matworld, matTemp

D3DXMatrixIdentity matTemp
D3DXMatrixRotationZ matTemp, .Z * sngRad
D3DXMatrixMultiply matworld, matworld, matTemp
End With

With Position
D3DXMatrixIdentity matTemp
D3DXMatrixTranslation matTemp, .X, .Y, .Z
D3DXMatrixMultiply matworld, matworld, matTemp
End With
  
D3DDevice.SetTransform D3DTS_WORLD, matworld
End Sub
